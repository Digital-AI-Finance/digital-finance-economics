{
  "lesson": "L06",
  "title": "Market Microstructure in Digital Finance",
  "questions": [
    {
      "id": 1,
      "question": "A market maker widens the bid-ask spread from $0.50 to $2.00. What economic condition most likely caused this?",
      "options": {
        "A": "Increased informed trading (adverse selection risk)",
        "B": "Higher trading volume",
        "C": "Lower asset volatility",
        "D": "More market makers joining"
      },
      "correct": "A",
      "explanation": "Wider spreads compensate market makers for adverse selection risk. When informed trading increases (higher sigma_v in Kyle's model), market makers widen spreads to protect themselves from trading against better-informed counterparties. Higher volume (B) would narrow spreads, lower volatility (C) reduces risk so spreads tighten, and more market makers (D) increase competition which narrows spreads."
    },
    {
      "id": 2,
      "question": "In an order book where the best bid is $1,795 and the best ask is $1,805, a trader submits a market buy order for 1 ETH. What price do they pay?",
      "options": {
        "A": "$1,795 (best bid)",
        "B": "$1,800 (mid-price)",
        "C": "$1,805 (best ask)",
        "D": "$1,810 (above best ask)"
      },
      "correct": "C",
      "explanation": "Market buy orders execute against the best ask (lowest sell price). The buyer takes the best available sell offer at $1,805. The bid price ($1,795) is what buyers are willing to pay, not what sellers are offering. The mid-price ($1,800) is a reference only, not an executable price."
    },
    {
      "id": 3,
      "question": "A DEX pool has 500 ETH and 1,000,000 USDC (k = 500,000,000). What is the spot price of ETH?",
      "options": {
        "A": "$500",
        "B": "$1,000",
        "C": "$2,000",
        "D": "$5,000"
      },
      "correct": "C",
      "explanation": "Spot price P = y/x = 1,000,000/500 = $2,000 per ETH. The spot price in a constant product AMM is always the ratio of the quote token reserve (USDC) to the base token reserve (ETH)."
    },
    {
      "id": 4,
      "question": "If you buy 50 ETH from a pool with 500 ETH and 1,000,000 USDC, what is your approximate effective price per ETH?",
      "options": {
        "A": "$2,000 (same as spot)",
        "B": "$2,222 (11% slippage)",
        "C": "$2,500 (25% slippage)",
        "D": "$3,000 (50% slippage)"
      },
      "correct": "B",
      "explanation": "New x = 450, new y = k/450 = 500,000,000/450 = 1,111,111. Cost = 1,111,111 - 1,000,000 = $111,111. Effective price = 111,111/50 = $2,222. Slippage = (2,222-2,000)/2,000 = 11.1%. This illustrates that buying 10% of a pool's reserves causes significant price impact."
    },
    {
      "id": 5,
      "question": "In an AMM using the constant product formula x*y=k, what happens to k when trades occur?",
      "options": {
        "A": "k increases with each trade",
        "B": "k decreases with each trade",
        "C": "k remains constant (ignoring fees)",
        "D": "k fluctuates randomly"
      },
      "correct": "C",
      "explanation": "The constant product formula maintains k constant during trades (ignoring fees). This ensures that x*y=k always holds, where x and y are the token reserves."
    },
    {
      "id": 6,
      "question": "If an AMM pool has 1000 Token X and 1000 Token Y with k=1,000,000, what is the initial spot price of X in terms of Y?",
      "options": {
        "A": "0.5 Y per X",
        "B": "1.0 Y per X",
        "C": "2.0 Y per X",
        "D": "1000 Y per X"
      },
      "correct": "B",
      "explanation": "The spot price is y/x = 1000/1000 = 1.0. This means one unit of Token X can be exchanged for one unit of Token Y at this initial state."
    },
    {
      "id": 7,
      "question": "In the constant product AMM, when you buy Token X from the pool, what happens to the reserves?",
      "options": {
        "A": "Both x and y increase",
        "B": "x decreases and y increases",
        "C": "x increases and y decreases",
        "D": "Both x and y decrease"
      },
      "correct": "B",
      "explanation": "When buying Token X, you remove X from the pool (x decreases) and add Token Y to the pool (y increases), maintaining x*y=k."
    },
    {
      "id": 8,
      "question": "According to the AMM constant product model, what causes slippage?",
      "options": {
        "A": "Network congestion",
        "B": "The non-linear price curve along x*y=k",
        "C": "Gas fees",
        "D": "Exchange rate fluctuations"
      },
      "correct": "B",
      "explanation": "Slippage arises because the price changes along the hyperbolic curve x*y=k. Larger trades move further along this curve, resulting in progressively worse prices."
    },
    {
      "id": 9,
      "question": "What is price discovery in fragmented markets?",
      "options": {
        "A": "The process by which a single exchange sets the official price for all markets",
        "B": "The mechanism through which information is incorporated into prices across multiple venues",
        "C": "The algorithm used to calculate mid-prices",
        "D": "The arbitrage mechanism that eliminates price differences across venues"
      },
      "correct": "B",
      "explanation": "Price discovery is the process through which new information is incorporated into asset prices. In fragmented markets, this occurs across multiple trading venues with varying speeds. Option A is wrong because no single exchange sets prices. Option D describes arbitrage, which is a component of price discovery but not the full definition."
    },
    {
      "id": 10,
      "question": "In fragmented markets, what is a 'leader' exchange?",
      "options": {
        "A": "The exchange with the highest number of listed trading pairs",
        "B": "The exchange where price movements occur first",
        "C": "The exchange with the lowest fees",
        "D": "The most regulated exchange"
      },
      "correct": "B",
      "explanation": "A leader exchange is one where price shocks and new information are reflected first, with other exchanges following with various time lags."
    },
    {
      "id": 11,
      "question": "Why might different exchanges show high correlation in their price movements?",
      "options": {
        "A": "They use the same trading software",
        "B": "Arbitrage forces prices to converge across venues",
        "C": "Regulatory requirements mandate price alignment",
        "D": "All exchanges share the same order book"
      },
      "correct": "B",
      "explanation": "Arbitrage opportunities arise when prices diverge across exchanges. Arbitrageurs exploit these differences, which forces prices to converge and creates high correlation."
    },
    {
      "id": 12,
      "question": "If you want to buy a large amount of Token X in an AMM, what trading strategy minimizes price impact?",
      "options": {
        "A": "Execute the entire trade at once",
        "B": "Break the trade into smaller chunks over time",
        "C": "Wait for the price to change first",
        "D": "Use leverage to increase buying power"
      },
      "correct": "B",
      "explanation": "Breaking large trades into smaller chunks reduces the immediate price impact along the x*y=k curve. This is the principle behind limit orders and TWAP (Time-Weighted Average Price) strategies."
    },
    {
      "id": 13,
      "question": "What is impermanent loss?",
      "options": {
        "A": "The loss from gas fees in providing liquidity",
        "B": "The loss from price volatility in the broader market",
        "C": "The opportunity cost of providing liquidity vs. holding tokens when prices diverge",
        "D": "The permanent loss when a liquidity pool is exploited"
      },
      "correct": "C",
      "explanation": "Impermanent loss is the difference in value between holding tokens and providing them to a liquidity pool when the price ratio changes. It's called 'impermanent' because it can reverse if prices return to the original ratio."
    },
    {
      "id": 14,
      "question": "For a liquidity provider in a constant product AMM, when does impermanent loss occur?",
      "options": {
        "A": "Only when prices decrease",
        "B": "Only when prices increase",
        "C": "When prices diverge in either direction from the initial ratio",
        "D": "Only during high volatility periods"
      },
      "correct": "C",
      "explanation": "Impermanent loss occurs whenever the price ratio changes from the initial deposit point, regardless of direction. The loss increases with larger price movements."
    },
    {
      "id": 15,
      "question": "If the price of one token doubles (2x) relative to the other in an AMM pool, approximately what is the impermanent loss?",
      "options": {
        "A": "0%",
        "B": "5.7%",
        "C": "10%",
        "D": "25%"
      },
      "correct": "B",
      "explanation": "For a 2x price change, the impermanent loss is approximately 5.7%. The formula is: IL = (2*sqrt(r))/(1+r) - 1, where r is the price ratio. At r=2, IL = 2*sqrt(2)/(1+2) - 1 = 2*1.414/3 - 1 = -5.7%."
    },
    {
      "id": 16,
      "question": "What is the mathematical relationship for calculating LP position value given initial deposit V_0 and price ratio r?",
      "options": {
        "A": "V_0 * r",
        "B": "V_0 * sqrt(r)",
        "C": "V_0 * r^2",
        "D": "V_0 / sqrt(r)"
      },
      "correct": "B",
      "explanation": "The LP position value follows V = V_0 * sqrt(r) due to the constant product formula. This is why impermanent loss occurs -- the square root function grows slower than a linear hold strategy."
    },
    {
      "id": 17,
      "question": "Why is MEV possible on blockchains but not typically in traditional stock exchanges?",
      "options": {
        "A": "Blockchains have higher fees",
        "B": "Block producers can choose the order of transactions within a block",
        "C": "Blockchain prices are more volatile",
        "D": "Traditional exchanges have more liquidity"
      },
      "correct": "B",
      "explanation": "MEV (Maximal Extractable Value, formerly Miner Extractable Value) exists because block producers (validators) control transaction ordering within blocks. In traditional exchanges, orders are processed by time priority (first-come-first-served), preventing most ordering-based extraction. This asymmetry in transaction ordering power is the fundamental source of MEV."
    },
    {
      "id": 18,
      "question": "What is a sandwich attack in the context of MEV?",
      "options": {
        "A": "Executing three trades simultaneously across different exchanges",
        "B": "Placing a front-run and back-run transaction around a victim's trade to profit from price movement",
        "C": "Splitting a large order into multiple smaller orders",
        "D": "Trading between three different token pairs"
      },
      "correct": "B",
      "explanation": "A sandwich attack involves: (1) front-running the victim's trade to move the price, (2) letting the victim trade at the worse price, (3) back-running to reverse the position and capture profit."
    },
    {
      "id": 19,
      "question": "How does Uniswap v3's concentrated liquidity improve capital efficiency compared to v2?",
      "options": {
        "A": "It reduces trading fees",
        "B": "LPs deposit liquidity only within a chosen price range, so more capital is active near the current price",
        "C": "It eliminates impermanent loss entirely",
        "D": "It uses a different formula than x*y=k"
      },
      "correct": "B",
      "explanation": "In v2, liquidity is spread across all prices (0 to infinity), so most capital is idle. V3 lets LPs concentrate liquidity in a specific range, providing much deeper liquidity near the current price. This can provide up to 4000x better capital efficiency for tight ranges, though LPs must actively manage their positions."
    },
    {
      "id": 20,
      "question": "What determines the optimal front-run size in a sandwich attack?",
      "options": {
        "A": "The maximum amount the attacker can afford",
        "B": "Exactly matching the victim's trade size",
        "C": "The trade-off between price impact and profit extraction given the victim's trade size",
        "D": "The current gas price"
      },
      "correct": "C",
      "explanation": "The optimal front-run size balances price manipulation (moving the price enough to profit) against the cost of moving the price too far. There's a profit-maximizing front-run size that depends on the victim's trade size and the pool's liquidity."
    },
    {
      "id": 21,
      "question": "An LP provides liquidity to an ETH/USDC pool. If ETH price triples (3x), what is the approximate impermanent loss?",
      "options": {
        "A": "-5.7%",
        "B": "-13.4%",
        "C": "-25.5%",
        "D": "-50%"
      },
      "correct": "B",
      "explanation": "IL = 2*sqrt(3)/(1+3) - 1 = 2*1.732/4 - 1 = 3.464/4 - 1 = 0.866 - 1 = -0.134 = -13.4%. A 3x price move causes significant impermanent loss, illustrating why LPs in volatile pairs need high fee income to remain profitable."
    },
    {
      "id": 22,
      "question": "Which characteristic makes AMMs superior to order books for long-tail (rarely traded) assets?",
      "options": {
        "A": "Lower slippage for large trades",
        "B": "Guaranteed liquidity without requiring active market makers",
        "C": "Faster execution speed",
        "D": "Lower transaction fees"
      },
      "correct": "B",
      "explanation": "AMMs provide guaranteed liquidity through the x*y=k formula -- anyone can trade at any time as long as the pool has reserves. Order books for illiquid assets may have no market makers willing to quote, meaning no counterparty to trade with. This permissionless liquidity is AMMs' key innovation for the long tail of assets."
    },
    {
      "id": 23,
      "question": "Which mechanism would most effectively prevent sandwich attacks?",
      "options": {
        "A": "Increasing gas fees to make attacks expensive",
        "B": "Encrypted mempools that hide pending transactions from attackers",
        "C": "Larger liquidity pools that reduce slippage",
        "D": "Faster block times"
      },
      "correct": "B",
      "explanation": "Sandwich attacks require seeing the victim's pending transaction in the mempool. Encrypted mempools hide transaction details until they are included in a block, preventing attackers from identifying and front-running victim trades. Larger pools (C) reduce profitability but don't eliminate the attack vector. Faster blocks (D) reduce the window but don't prevent ordering manipulation within a block."
    },
    {
      "id": 24,
      "question": "In a fragmented market with both CEXs and DEXs, what role do arbitrageurs play in price discovery?",
      "options": {
        "A": "They increase volatility by making large speculative trades",
        "B": "They align prices across venues by buying low on one exchange and selling high on another",
        "C": "They provide liquidity by placing limit orders on all exchanges",
        "D": "They reduce trading volume by discouraging retail participation"
      },
      "correct": "B",
      "explanation": "Arbitrageurs enforce the law of one price by buying assets on exchanges where they are cheaper and selling where they are more expensive. This cross-venue activity transmits price information between markets, ensuring that CEX and DEX prices stay aligned. Without arbitrage, prices could diverge significantly across fragmented venues."
    }
  ]
}
